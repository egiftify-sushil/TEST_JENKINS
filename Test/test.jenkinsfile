pipeline {
    agent any
    tools {
        jdk 'jdk14'
        jdk 'jdk17'      
        nodejs 'nodejs14'
    }
   
    stages {
        stage('Preparing for upload') {
            steps {
                script {
                    cleanWs()
                }
            }
        }

        stage('Creating PHP patch') {
            steps {
                // Display node version
                sh '''
                node -v
                '''
                
                // Set JAVA_HOME and PATH for JDK 14
                withEnv(["JAVA_HOME=${tool 'jdk14'}", "PATH=${tool 'jdk14'}/bin:$PATH"]) {
                    sh '''
                    echo "Using JDK 14"
                    java -version
                    '''
                }
                
                // Set JAVA_HOME and PATH for JDK 17
                withEnv(["JAVA_HOME=${tool 'jdk17'}", "PATH=${tool 'jdk17'}/bin:$PATH"]) {
                    sh '''
                    echo "Using JDK 17"
                    java -version
                    '''
                }
            }
        }
    }
    post {
        success {
            script {
                buildStatus = 'SUCCESS'
            }
        }
        unstable {
            script {
                buildStatus = 'UNSTABLE'
            }
        }
        failure {
            script {
                buildStatus = false
            }
        }
    }
}
